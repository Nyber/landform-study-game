<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Landform Explorer - Interactive Learning Adventure</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --success-color: #4ade80;
            --warning-color: #fbbf24;
            --error-color: #f87171;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            --border-radius: 16px;
            --border-radius-lg: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 1rem;
            position: relative;
            overflow-x: hidden;
        }

        /* Background effects */
        .bg-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: float-particle 20s infinite linear;
        }

        @keyframes float-particle {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        .floating-landform {
            position: fixed;
            font-size: 3rem;
            opacity: 0.1;
            animation: float-slow 25s infinite ease-in-out;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes float-slow {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-30px) rotate(5deg); }
            50% { transform: translateY(0) rotate(-3deg); }
            75% { transform: translateY(20px) rotate(4deg); }
        }

        /* Main container */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        /* Glassmorphism card */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-2xl);
            padding: 2rem;
            transition: var(--transition);
        }

        .glass-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 32px 64px -12px rgb(0 0 0 / 0.35);
        }

        /* Navigation */
        .nav-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--warning-color), #f59e0b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .nav-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .user-level {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            color: white;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .xp-bar {
            width: 60px;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--warning-color), #f59e0b);
            width: 65%;
            transition: var(--transition);
        }

        /* Typography */
        .title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 400;
        }

        /* Button styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            border: none;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            min-height: 56px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #22c55e);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #f59e0b);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .btn-accent {
            background: linear-gradient(135deg, var(--accent-color), #f093fb);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .submit-container {
            margin-top: 2rem;
            text-align: center;
            animation: slideInUp 0.3s ease;
        }

        .submit-btn {
            font-size: 1.1rem;
            padding: 1rem 2rem;
            min-width: 180px;
            transition: all 0.3s ease;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn-ghost {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .btn-ghost:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        /* Mode selection */
        .mode-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .mode-card {
            background: var(--bg-secondary);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .mode-card:hover::before {
            transform: scaleX(1);
        }

        .mode-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }

        .mode-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .mode-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .mode-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Landform images */
        .landform-image-container {
            width: 100%;
            height: 300px;
            border-radius: var(--border-radius);
            overflow: hidden;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-lg);
            position: relative;
        }

        .landform-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .landform-image:hover {
            transform: scale(1.05);
        }

        .image-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            color: white;
            padding: 1.5rem;
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* Game stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Progress indicators */
        .progress-container {
            margin: 2rem 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .progress-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .progress-percentage {
            font-weight: 600;
            color: var(--primary-color);
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            border-radius: 6px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Question cards */
        .question-card {
            background: var(--bg-secondary);
            border-radius: var(--border-radius-lg);
            padding: 2.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
            border: 2px solid transparent;
            transition: var(--transition);
        }

        .question-card:hover {
            border-color: var(--primary-color);
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            gap: 1rem;
        }

        .option-btn {
            background: var(--bg-secondary);
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            padding: 1.25rem 1.5rem;
            text-align: left;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-primary);
            position: relative;
            overflow: hidden;
        }

        .option-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .option-btn:hover::before {
            left: 100%;
        }

        .option-btn:hover {
            border-color: var(--primary-color);
            transform: translateX(8px);
            box-shadow: var(--shadow-md);
        }

        .option-btn.selected {
            background: linear-gradient(135deg, #ddd6fe, #c4b5fd);
            border-color: var(--primary-color);
            transform: translateX(8px);
            box-shadow: var(--shadow-md);
        }

        .option-btn.correct {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border-color: var(--success-color);
            animation: success-bounce 0.6s ease;
        }

        .option-btn.incorrect {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-color: var(--error-color);
            animation: error-shake 0.6s ease;
        }

        @keyframes success-bounce {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.05); }
            50% { transform: scale(1.02); }
            75% { transform: scale(1.03); }
        }

        @keyframes error-shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }

        /* Achievements */
        .achievements-section {
            margin: 2rem 0;
        }

        .achievements-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 1rem;
        }

        .achievement-badge {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1.5rem 1rem;
            text-align: center;
            transition: var(--transition);
            border: 2px solid #e2e8f0;
            cursor: pointer;
        }

        .achievement-badge.earned {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-color: var(--warning-color);
            animation: achievement-glow 2s infinite alternate;
        }

        .achievement-badge:hover {
            transform: scale(1.05);
        }

        @keyframes achievement-glow {
            0% { box-shadow: 0 0 10px rgba(251, 191, 36, 0.3); }
            100% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.6); }
        }

        .achievement-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .achievement-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Feedback messages */
        .feedback-card {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-top: 1.5rem;
            border-left: 4px solid var(--primary-color);
            animation: feedback-slide 0.5s ease;
        }

        @keyframes feedback-slide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback-card.success {
            border-left-color: var(--success-color);
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }

        .feedback-card.error {
            border-left-color: var(--error-color);
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
        }

        .fun-fact {
            background: linear-gradient(135deg, #faf5ff, #f3e8ff);
            border: 2px solid #c084fc;
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-top: 1rem;
            font-style: italic;
        }

        /* Control buttons */
        .controls {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            z-index: 100;
        }

        .control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            color: var(--primary-color);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
        }

        .control-btn:hover, .control-btn:active {
            transform: scale(1.1);
            background: var(--primary-color);
            color: white;
        }

        /* Home button - always visible */
        .home-btn {
            position: fixed;
            top: 2rem;
            left: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: var(--primary-color);
            font-size: 1.8rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            -webkit-tap-highlight-color: transparent;
        }

        .home-btn:hover, .home-btn:active {
            transform: scale(1.1);
            background: var(--primary-color);
            color: white;
        }

        /* Loading states */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .app-container {
                padding: 0 0.5rem;
                margin-top: 5rem; /* Space for home button */
            }

            .glass-card {
                padding: 1.5rem;
                margin: 0.5rem;
            }

            .nav-bar {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
                margin-top: 1rem;
            }

            .mode-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .question-card {
                padding: 1.5rem;
            }

            .controls {
                bottom: 1rem;
                right: 1rem;
            }

            .control-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .home-btn {
                top: 1rem;
                left: 1rem;
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
        }

        /* iPad specific optimizations */
        @media (min-width: 768px) and (max-width: 1024px) {
            .app-container {
                max-width: 900px;
                margin-top: 2rem; /* Space for home button */
            }

            .mode-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .question-card {
                padding: 2rem;
            }

            .option-btn {
                padding: 1.5rem;
                font-size: 1.2rem;
                min-height: 60px;
            }

            .btn {
                min-height: 60px;
                padding: 1.2rem 2.5rem;
                font-size: 1.1rem;
            }

            .mode-card {
                padding: 2.5rem;
            }

            .mode-icon {
                width: 100px;
                height: 100px;
                font-size: 2.5rem;
            }

            /* Make all interactive elements larger for touch */
            .control-btn, .home-btn {
                width: 65px;
                height: 65px;
                font-size: 1.8rem;
            }

            .achievement-badge {
                padding: 2rem 1.5rem;
            }
        }

        /* Large iPad Pro and desktop adjustments */
        @media (min-width: 1024px) {
            .app-container {
                margin-top: 1rem;
            }
        }

        /* Screen transitions */
        .screen {
            display: none;
            animation: screen-enter 0.5s ease-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes screen-enter {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Particle system for celebrations */
        .celebration-particle {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
            font-size: 1.5rem;
            animation: celebrate 3s ease-out forwards;
        }

        @keyframes celebrate {
            0% {
                opacity: 1;
                transform: translateY(0) rotateZ(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-200px) rotateZ(180deg);
            }
        }

        /* Theme variations */
        .theme-nature {
            --primary-color: #059669;
            --secondary-color: #0d9488;
            --accent-color: #06b6d4;
        }

        .theme-volcano {
            --primary-color: #dc2626;
            --secondary-color: #ea580c;
            --accent-color: #f59e0b;
        }

        .theme-ocean {
            --primary-color: #0ea5e9;
            --secondary-color: #0284c7;
            --accent-color: #06b6d4;
        }
    </style>
</head>
<body>
    <!-- Background particles -->
    <div class="bg-particles" id="bgParticles"></div>
    
    <!-- Floating landforms -->
    <div class="floating-landform" style="top: 10%; left: 5%;">🏔️</div>
    <div class="floating-landform" style="top: 20%; right: 10%; animation-delay: 3s;">🌋</div>
    <div class="floating-landform" style="bottom: 30%; left: 8%; animation-delay: 6s;">🏞️</div>
    <div class="floating-landform" style="bottom: 20%; right: 5%; animation-delay: 9s;">🏜️</div>
    <div class="floating-landform" style="top: 60%; left: 3%; animation-delay: 12s;">⛰️</div>

    <!-- Home Button - Always Visible -->
    <button class="home-btn" onclick="goHome()" title="Go Home">🏠</button>

    <div class="app-container">
        <!-- Navigation -->
        <nav class="nav-bar">
            <div class="logo">
                <div class="logo-icon">🌍</div>
                <span>Landform Explorer</span>
            </div>
            <div class="nav-controls">
                <div class="user-level" id="userLevel">
                    <span>Level 1</span>
                    <div class="xp-bar">
                        <div class="xp-fill" id="xpFill"></div>
                    </div>
                    <span id="xpText">65/100 XP</span>
                </div>
                <button class="btn btn-ghost" onclick="toggleTheme()">🎨</button>
            </div>
        </nav>

        <!-- Home Screen -->
        <div class="screen active" id="homeScreen">
            <div class="glass-card">
                <h1 class="title">Welcome to Landform Explorer!</h1>
                <p class="subtitle">Embark on an epic journey to master Earth's incredible landforms</p>

                <div class="mode-grid">
                    <div class="mode-card" onclick="showDifficultySelection()">
                        <div class="mode-icon">🎯</div>
                        <h3 class="mode-title">Quiz Challenge</h3>
                        <p class="mode-description">Test your knowledge with interactive quizzes and earn achievements</p>
                    </div>

                    <div class="mode-card" onclick="startTimeChallenge()">
                        <div class="mode-icon">⚡</div>
                        <h3 class="mode-title">Speed Challenge</h3>
                        <p class="mode-description">Race against time in this thrilling rapid-fire quiz mode</p>
                    </div>

                    <div class="mode-card" onclick="startStudyMode()">
                        <div class="mode-icon">📚</div>
                        <h3 class="mode-title">Study Mode</h3>
                        <p class="mode-description">Explore beautiful landforms with stunning images and fascinating facts</p>
                    </div>
                </div>

                <!-- Achievements Section -->
                <div class="achievements-section">
                    <h2 class="achievements-title">🏆 Your Achievements</h2>
                    <div class="achievements-grid" id="achievementsGrid"></div>
                </div>
            </div>
        </div>

        <!-- Difficulty Selection -->
        <div class="screen" id="difficultyScreen">
            <div class="glass-card">
                <h2 class="title">Choose Your Challenge Level</h2>
                <div class="mode-grid">
                    <div class="mode-card" onclick="startQuiz('easy')">
                        <div class="mode-icon" style="background: linear-gradient(135deg, #22c55e, #16a34a);">🌱</div>
                        <h3 class="mode-title">Explorer</h3>
                        <p class="mode-description">Perfect for beginners. Learn the basics with guided questions.</p>
                    </div>
                    <div class="mode-card" onclick="startQuiz('medium')">
                        <div class="mode-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">🌿</div>
                        <h3 class="mode-title">Adventurer</h3>
                        <p class="mode-description">Ready for a challenge? Test your growing knowledge.</p>
                    </div>
                    <div class="mode-card" onclick="startQuiz('hard')">
                        <div class="mode-icon" style="background: linear-gradient(135deg, #dc2626, #b91c1c);">🌳</div>
                        <h3 class="mode-title">Master</h3>
                        <p class="mode-description">Expert level with advanced concepts and tricky questions.</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-ghost" onclick="showScreen('homeScreen')">← Back to Home</button>
                </div>
            </div>
        </div>

        <!-- Study Mode Screen -->
        <div class="screen" id="studyScreen">
            <div class="glass-card">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <button class="btn btn-ghost" onclick="showScreen('homeScreen')">← Back to Home</button>
                </div>
                <div id="studyContent"></div>
                <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="previousLandform()">← Previous</button>
                    <button class="btn btn-primary" onclick="nextLandform()">Next →</button>
                </div>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div class="screen" id="quizScreen">
            <div class="glass-card">
                <!-- Game Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="scoreValue">0</div>
                        <div class="stat-label">Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="questionNumber">1</div>
                        <div class="stat-label">Question</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="accuracyValue">0%</div>
                        <div class="stat-label">Accuracy</div>
                    </div>
                    <div class="stat-card" id="streakCard" style="display: none;">
                        <div class="stat-value" id="streakValue">0</div>
                        <div class="stat-label">🔥 Streak</div>
                    </div>
                    <div class="stat-card" id="timerCard" style="display: none;">
                        <div class="stat-value" id="timerValue">30</div>
                        <div class="stat-label">⏱️ Time</div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container">
                    <div class="progress-header">
                        <span class="progress-title">Progress</span>
                        <span class="progress-percentage" id="progressPercentage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                    </div>
                </div>

                <!-- Question Content -->
                <div id="questionContent"></div>

                <!-- Next Button -->
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-success" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                        Next Question →
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div class="screen" id="resultsScreen">
            <div class="glass-card">
                <div style="text-align: center;">
                    <h2 class="title">🎉 Adventure Complete!</h2>
                    <div style="font-size: 4rem; margin: 2rem 0;" id="finalScoreDisplay">0/10</div>
                    <div style="font-size: 1.5rem; margin-bottom: 2rem; color: var(--text-primary);" id="resultMessage"></div>
                    
                    <!-- High Scores -->
                    <div style="background: var(--bg-primary); padding: 2rem; border-radius: var(--border-radius); margin: 2rem 0;">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">🏆 High Scores</h3>
                        <div id="highScoresList"></div>
                    </div>

                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="showScreen('homeScreen')">🏠 Home</button>
                        <button class="btn btn-success" onclick="restartQuiz()">🔄 Play Again</button>
                        <button class="btn btn-accent" onclick="shareResults()">📱 Share</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Control Buttons -->
    <div class="controls">
        <button class="control-btn" id="soundToggle" onclick="toggleSound()" title="Toggle Sound">🔊</button>
        <button class="control-btn" onclick="showHints()" title="Hints">💡</button>
        <button class="control-btn" onclick="showSettings()" title="Settings">⚙️</button>
    </div>

    <!-- Achievement Popup -->
    <div id="achievementPopup" style="display: none;"></div>

    <script>
        // Game State Management
        class GameState {
            constructor() {
                this.currentQuestion = 0;
                this.score = 0;
                this.totalQuestions = 10;
                this.answered = false;
                this.streak = 0;
                this.maxStreak = 0;
                this.gameMode = 'normal';
                this.difficulty = 'medium';
                this.timeLeft = 30;
                this.timer = null;
                this.totalAnswered = 0;
                this.correctAnswers = 0;
                this.currentStudyIndex = 0;
                this.xp = parseInt(localStorage.getItem('xp') || '65');
                this.level = Math.floor(this.xp / 100) + 1;
                this.soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
                this.theme = localStorage.getItem('theme') || 'default';
                this.achievements = JSON.parse(localStorage.getItem('achievements') || '[]');
                this.highScores = JSON.parse(localStorage.getItem('highScores') || '[]');
            }

            save() {
                localStorage.setItem('xp', this.xp.toString());
                localStorage.setItem('soundEnabled', this.soundEnabled.toString());
                localStorage.setItem('theme', this.theme);
                localStorage.setItem('achievements', JSON.stringify(this.achievements));
                localStorage.setItem('highScores', JSON.stringify(this.highScores));
            }

            addXP(amount) {
                this.xp += amount;
                const newLevel = Math.floor(this.xp / 100) + 1;
                if (newLevel > this.level) {
                    this.level = newLevel;
                    this.showAchievement('level_up', `Level ${this.level} Reached!`);
                }
                this.updateXPDisplay();
                this.save();
            }

            updateXPDisplay() {
                const xpInLevel = this.xp % 100;
                const xpNeeded = 100;
                document.getElementById('xpFill').style.width = `${(xpInLevel / xpNeeded) * 100}%`;
                document.getElementById('xpText').textContent = `${xpInLevel}/${xpNeeded} XP`;
                document.querySelector('.user-level span').textContent = `Level ${this.level}`;
            }

            showAchievement(id, title, description = '') {
                if (this.achievements.includes(id)) return;
                
                this.achievements.push(id);
                this.save();
                
                // Create achievement popup
                const popup = document.createElement('div');
                popup.className = 'glass-card';
                popup.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%) scale(0);
                    z-index: 1000;
                    text-align: center;
                    animation: achievement-popup 0.5s ease forwards;
                    max-width: 400px;
                `;
                
                popup.innerHTML = `
                    <div style="font-size: 4rem; margin-bottom: 1rem;">🏆</div>
                    <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">Achievement Unlocked!</h3>
                    <h4 style="margin-bottom: 1rem;">${title}</h4>
                    <p style="color: var(--text-secondary);">${description}</p>
                `;
                
                document.body.appendChild(popup);
                
                // Add achievement popup animation
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes achievement-popup {
                        to { transform: translate(-50%, -50%) scale(1); }
                    }
                `;
                document.head.appendChild(style);
                
                this.playSound('achievement');
                this.createCelebration();
                
                setTimeout(() => {
                    popup.remove();
                    style.remove();
                }, 3000);
                
                this.updateAchievementsDisplay();
            }

            createCelebration() {
                const emojis = ['🎉', '🎊', '⭐', '✨', '🌟', '🎈', '🏆'];
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'celebration-particle';
                    particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 0.5 + 's';
                    document.body.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 3000);
                }
            }

            playSound(type) {
                if (!this.soundEnabled) return;
                
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = context.createOscillator();
                const gainNode = context.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(context.destination);
                
                const sounds = {
                    correct: [523.25, 659.25, 783.99], // C-E-G major chord
                    incorrect: [200, 150], // Low tones
                    achievement: [440, 554.37, 659.25, 880], // A-C#-E-A
                    button: [300], // Simple click
                    complete: [523.25, 659.25, 783.99, 1046.5] // C-E-G-C octave
                };
                
                const frequencies = sounds[type] || sounds.button;
                frequencies.forEach((freq, i) => {
                    setTimeout(() => {
                        oscillator.frequency.setValueAtTime(freq, context.currentTime);
                    }, i * 100);
                });
                
                gainNode.gain.setValueAtTime(0.1, context.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.5);
                oscillator.start(context.currentTime);
                oscillator.stop(context.currentTime + 0.5);
            }

            updateAchievementsDisplay() {
                const grid = document.getElementById('achievementsGrid');
                const allAchievements = [
                    { id: 'first_correct', icon: '👣', name: 'First Steps' },
                    { id: 'perfect_score', icon: '🎯', name: 'Perfect!' },
                    { id: 'streak_5', icon: '🔥', name: 'On Fire' },
                    { id: 'streak_10', icon: '⚡', name: 'Unstoppable' },
                    { id: 'speed_demon', icon: '💨', name: 'Speed Demon' },
                    { id: 'study_master', icon: '📚', name: 'Scholar' },
                    { id: 'time_master', icon: '⏱️', name: 'Time Master' },
                    { id: 'explorer', icon: '🗺️', name: 'Explorer' }
                ];
                
                grid.innerHTML = allAchievements.map(achievement => `
                    <div class="achievement-badge ${this.achievements.includes(achievement.id) ? 'earned' : ''}">
                        <div class="achievement-icon">${this.achievements.includes(achievement.id) ? achievement.icon : '🔒'}</div>
                        <div class="achievement-name">${this.achievements.includes(achievement.id) ? achievement.name : '???'}</div>
                    </div>
                `).join('');
            }
        }

        // Enhanced landform data with real image URLs
        const landformData = [
            {
                name: 'Mountain',
                emoji: '🏔️',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3kiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMCUiIHkyPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjODdDRUVCIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjRTBGNkZGIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9Im1vdW50YWluIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI0ZGRkZGRiIvPjxzdG9wIG9mZnNldD0iMjAlIiBzdG9wLWNvbG9yPSIjRjNGNEY2Ii8+PHN0b3Agb2Zmc2V0PSI2MCUiIHN0b3AtY29sb3I9IiM2QjczODAiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMzNzQxNTEiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0idXJsKCNza3kpIi8+PHBvbHlnb24gcG9pbnRzPSIyMDAsNTAgMzAwLDI1MCA5MCwyNTAiIGZpbGw9InVybCgjbW91bnRhaW4pIi8+PHBvbHlnb24gcG9pbnRzPSIzMDAsMTAwIDM4MCwyNTAgMjIwLDI1MCIgZmlsbD0idXJsKCNtb3VudGFpbikiLz48cG9seWdvbiBwb2ludHM9IjEwMCwxMjAgMTgwLDI1MCAyMCwyNTAiIGZpbGw9InVybCgjbW91bnRhaW4pIi8+PHJlY3QgeT0iMjUwIiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjMjJDNTVFIi8+PC9zdmc+',
                description: 'Mountains are massive landforms that rise dramatically above the surrounding terrain. They are formed through tectonic forces and can reach incredible heights with snow-capped peaks.',
                facts: [
                    'Mount Everest is 29,032 feet tall - taller than 20 Empire State Buildings stacked!',
                    'Mountains cover about 24% of Earth\'s land surface',
                    'The youngest mountains are the Himalayas, still growing 4mm per year',
                    'Mountains create their own weather patterns and climates'
                ]
            },
            {
                name: 'Volcano',
                emoji: '🌋',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3kyIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzFGMkEzNyIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzM3NDE1MSIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJ2b2xjYW5vIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzc0MUEyQSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzNGMUExNyIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJsYXZhIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI0ZCQkYyNCIvPjxzdG9wIG9mZnNldD0iNTAlIiBzdG9wLWNvbG9yPSIjRkY2QzAwIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjREMyNjI2Ii8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjQwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9InVybCgjc2t5MikiLz48cG9seWdvbiBwb2ludHM9IjIwMCw4MCAyODAsMjUwIDEyMCwyNTAiIGZpbGw9InVybCgjdm9sY2FubykiLz48cmVjdCB4PSIxOTAiIHk9IjcwIiB3aWR0aD0iMjAiIGhlaWdodD0iMTAiIGZpbGw9InVybCgjbGF2YSkiLz48Y2lyY2xlIGN4PSIxODUiIGN5PSI1MCIgcj0iNSIgZmlsbD0iI0ZCQkYyNCIgb3BhY2l0eT0iMC44Ii8+PGNpcmNsZSBjeD0iMjAwIiBjeT0iNDAiIHI9IjciIGZpbGw9IiNGRjZDMDAiIG9wYWNpdHk9IjAuNyIvPjxjaXJjbGUgY3g9IjIxNSIgY3k9IjU1IiByPSI0IiBmaWxsPSIjREMyNjI2IiBvcGFjaXR5PSIwLjYiLz48cmVjdCB5PSIyNTAiIHdpZHRoPSI0MDAiIGhlaWdodD0iNTAiIGZpbGw9IiMyMkM1NUUiLz48L3N2Zz4=',
                description: 'Volcanoes are openings in Earth\'s crust where molten rock, gases, and debris can escape. They create spectacular mountains and islands through repeated eruptions.',
                facts: [
                    'There are about 1,500 active volcanoes worldwide',
                    'The Ring of Fire around the Pacific has 75% of all volcanoes',
                    'Volcanic soil is incredibly fertile for farming',
                    'Mauna Loa in Hawaii is the world\'s largest active volcano'
                ]
            },
            {
                name: 'Valley',
                emoji: '🏞️',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3kzIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzg3Q0VFQiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0UwRjZGRiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJoaWxscyIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiM2MzdCNzciLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiM0MzZFNDQiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0icml2ZXIiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMCUiIHkyPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjMzY5NEY2Ii8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjMUQ0RUQ4Ii8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjQwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9InVybCgjc2t5MykiLz48cG9seWdvbiBwb2ludHM9IjAsMTUwIDEwMCwyNTAgMCwyNTAiIGZpbGw9InVybCgjaGlsbHMpIi8+PHBvbHlnb24gcG9pbnRzPSI0MDAsMTIwIDMwMCwyNTAgNDAwLDI1MCIgZmlsbD0idXJsKCNoaWxscykiLz48cGF0aCBkPSJNMTAwIDI1MFEyMDAgMjAwIDMwMCAyNTAiIHN0cm9rZT0idXJsKCNyaXZlcikiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz48cmVjdCB5PSIyNTAiIHdpZHRoPSI0MDAiIGhlaWdodD0iNTAiIGZpbGw9IiMyMkM1NUUiLz48L3N2Zz4=',
                description: 'Valleys are low-lying areas between hills or mountains, often carved by rivers or formed by glacial activity. They provide fertile ground for agriculture and settlements.',
                facts: [
                    'The Great Rift Valley stretches 4,000 miles across Africa',
                    'Death Valley is 282 feet below sea level',
                    'Many valleys were carved by glaciers during ice ages',
                    'Silicon Valley gets its name from silicon computer chips'
                ]
            },
            {
                name: 'Canyon',
                emoji: '🏜️',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3k0IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI0ZCOUY0QSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0Y1OUUwQiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJyb2NrIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI0Y0NzMzMyIvPjxzdG9wIG9mZnNldD0iNTAlIiBzdG9wLWNvbG9yPSIjRUE1OTBDIS8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjOTIyNzA5Ii8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjQwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9InVybCgjc2t5NCkiLz48cmVjdCB4PSIwIiB5PSI1MCIgd2lkdGg9IjE1MCIgaGVpZ2h0PSIyMDAiIGZpbGw9InVybCgjcm9jaykiLz48cmVjdCB4PSIyNTAiIHk9IjUwIiB3aWR0aD0iMTUwIiBoZWlnaHQ9IjIwMCIgZmlsbD0idXJsKCNyb2NrKSIvPjxyZWN0IHg9IjE1MCIgeT0iMjMwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjIwIiBmaWxsPSIjM0I4MkY2Ii8+PC9zdmc+',
                description: 'Canyons are deep, narrow valleys with steep cliff walls, typically carved by rivers over millions of years. They reveal layers of Earth\'s geological history.',
                facts: [
                    'The Grand Canyon is 277 miles long and over 1 mile deep',
                    'It took the Colorado River 6 million years to carve the Grand Canyon',
                    'Antelope Canyon in Arizona is famous for its wave-like walls',
                    'Some slot canyons are so narrow you can touch both walls'
                ]
            },
            {
                name: 'Plain',
                emoji: '🌾',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3k1IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzg3Q0VFQiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0UwRjZGRiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSJ1cmwoI3NreTUpIi8+PHJlY3QgeT0iMTgwIiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjEyMCIgZmlsbD0iIzIyQzU1RSIvPjxyZWN0IHg9IjUwIiB5PSIxNjAiIHdpZHRoPSI0IiBoZWlnaHQ9IjIwIiBmaWxsPSIjRkJCRjI0Ii8+PHJlY3QgeD0iMTAwIiB5PSIxNTAiIHdpZHRoPSI0IiBoZWlnaHQ9IjMwIiBmaWxsPSIjRkJCRjI0Ii8+PHJlY3QgeD0iMjAwIiB5PSIxNDAiIHdpZHRoPSI0IiBoZWlnaHQ9IjQwIiBmaWxsPSIjRkJCRjI0Ii8+PHJlY3QgeD0iMzAwIiB5PSIxNTAiIHdpZHRoPSI0IiBoZWlnaHQ9IjMwIiBmaWxsPSIjRkJCRjI0Ii8+PHJlY3QgeD0iMzUwIiB5PSIxNjUiIHdpZHRoPSI0IiBoZWlnaHQ9IjE1IiBmaWxsPSIjRkJCRjI0Ii8+PGNpcmNsZSBjeD0iODAiIGN5PSI4MCIgcj0iMjAiIGZpbGw9IiNGQkJGMjQiIG9wYWNpdHk9IjAuOCIvPjwvc3ZnPg==',
                description: 'Plains are vast, flat expanses of land with minimal elevation changes. They are ideal for agriculture and support much of the world\'s food production.',
                facts: [
                    'Plains cover over one-third of Earth\'s land surface',
                    'The Great Plains produce 70% of America\'s wheat',
                    'They were formed by sediment deposits over millions of years',
                    'The Amazon River plain is the world\'s largest river plain'
                ]
            },
            {
                name: 'Plateau',
                emoji: '🏔️',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3k2IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzg3Q0VFQiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0UwRjZGRiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJwbGF0ZWF1IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzkyODA2RiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzc4NzE2QyIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSJ1cmwoI3NreTYpIi8+PHJlY3QgeD0iNTAiIHk9IjEwMCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIxNTAiIGZpbGw9InVybCgjcGxhdGVhdSkiLz48cmVjdCB4PSI1MCIgeT0iOTAiIHdpZHRoPSIzMDAiIGhlaWdodD0iMTAiIGZpbGw9IiMyMkM1NUUiLz48cmVjdCB5PSIyNTAiIHdpZHRoPSI0MDAiIGhlaWdodD0iNTAiIGZpbGw9IiMyMkM1NUUiLz48L3N2Zz4=',
                description: 'Plateaus are elevated flatlands that rise sharply above surrounding areas. Often called "tablelands," they can be found at various elevations around the world.',
                facts: [
                    'The Tibetan Plateau is called "The Roof of the World"',
                    'Plateaus can be formed by volcanic activity or tectonic uplift',
                    'The Colorado Plateau contains the Grand Canyon',
                    'Some plateaus are higher than many mountain peaks'
                ]
            },
            {
                name: 'Hill',
                emoji: '⛰️',
                imageUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJza3k3IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzg3Q0VFQiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0UwRjZGRiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJoaWxsIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzIyQzU1RSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzE2QTM0QSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSJ1cmwoI3NreTcpIi8+PGVsbGlwc2UgY3g9IjEwMCIgY3k9IjIwMCIgcng9IjgwIiByeT0iNTAiIGZpbGw9InVybCgjaGlsbCkiLz48ZWxsaXBzZSBjeD0iMjAwIiBjeT0iMTgwIiByeD0iOTAiIHJ5PSI3MCIgZmlsbD0idXJsKCNoaWxsKSIvPjxlbGxpcHNlIGN4PSIzMjAiIGN5PSIyMTAiIHJ4PSI3MCIgcnk9IjQwIiBmaWxsPSJ1cmwoI2hpbGwpIi8+PHJlY3QgeT0iMjUwIiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjMjJDNTVFIi8+PC9zdmc+',
                description: 'Hills are rounded elevations smaller than mountains, typically under 2,000 feet tall. They provide gentle slopes perfect for recreation and settlements.',
                facts: [
                    'Hills are generally considered smaller than mountains',
                    'The Chocolate Hills in Philippines turn brown in dry season',
                    'Many ancient civilizations built on hills for defense',
                    'Rolling hills are perfect for agriculture and grazing'
                ]
            }
        ];

        // Enhanced question data
        const questionData = [
            // Easy questions
            {
                type: 'multiple-choice',
                difficulty: 'easy',
                question: 'Which landform can erupt with hot lava and ash?',
                options: ['Hill', 'Plateau', 'Volcano', 'Plain'],
                correct: 2,
                explanation: 'Volcanoes are openings in Earth\'s crust where molten rock can escape!',
                funFact: '🌋 The word "volcano" comes from Vulcan, the Roman god of fire!'
            },
            {
                type: 'multiple-choice',
                difficulty: 'easy',
                question: 'What landform is perfect for farming because it\'s wide and flat?',
                options: ['Mountain', 'Plain', 'Canyon', 'Valley'],
                correct: 1,
                explanation: 'Plains are large, flat areas ideal for growing crops!',
                funFact: '🌾 The Great Plains produce enough wheat to feed millions of people!'
            },
            {
                type: 'multiple-choice',
                difficulty: 'easy',
                question: 'Which landform is the low area between hills or mountains?',
                options: ['Plateau', 'Hill', 'Valley', 'Canyon'],
                correct: 2,
                explanation: 'Valleys are the low-lying areas nestled between higher landforms!',
                funFact: '🏞️ Many cities are built in valleys because they\'re protected and have water!'
            },
            // Medium questions
            {
                type: 'multiple-choice',
                difficulty: 'medium',
                question: 'Which landform is a deep, narrow valley with steep walls carved by rivers?',
                options: ['Mountain', 'Canyon', 'Plateau', 'Plain'],
                correct: 1,
                explanation: 'Canyons are carved by rivers cutting through rock over millions of years!',
                funFact: '🏜️ The Grand Canyon reveals 2 billion years of Earth\'s history in its rock layers!'
            },
            {
                type: 'multiple-choice',
                difficulty: 'medium',
                question: 'What do we call a flat area of land at a high elevation?',
                options: ['Valley', 'Plain', 'Hill', 'Plateau'],
                correct: 3,
                explanation: 'Plateaus are like giant tables rising high above the surrounding land!',
                funFact: '🏔️ The Tibetan Plateau is so high it\'s called "The Roof of the World"!'
            },
            // Hard questions
            {
                type: 'multiple-choice',
                difficulty: 'hard',
                question: 'Which process primarily carved out most river valleys?',
                options: ['Volcanic eruption', 'Water erosion', 'Earthquake activity', 'Wind erosion'],
                correct: 1,
                explanation: 'Water erosion over thousands of years carves valleys as rivers flow downhill!',
                funFact: '💧 A single drop of water isn\'t powerful, but billions together can carve the Grand Canyon!'
            },
            {
                type: 'multiple-choice',
                difficulty: 'hard',
                question: 'What type of plateau is formed by repeated lava flows?',
                options: ['Tectonic plateau', 'Volcanic plateau', 'Erosional plateau', 'Glacial plateau'],
                correct: 1,
                explanation: 'Volcanic plateaus form when lava flows spread out and cool into flat surfaces!',
                funFact: '🌋 The Deccan Plateau in India was formed by massive lava flows 66 million years ago!'
            },
            // More questions for variety
            {
                type: 'multiple-choice',
                difficulty: 'easy',
                question: 'Which landform is smaller than a mountain but higher than the surrounding land?',
                options: ['Canyon', 'Plain', 'Hill', 'Valley'],
                correct: 2,
                explanation: 'Hills are gentle rises in the land, perfect for rolling down!',
                funFact: '⛰️ Some hills are actually worn-down mountains that used to be much taller!'
            },
            {
                type: 'multiple-choice',
                difficulty: 'medium',
                question: 'What landform covers more than one-third of Earth\'s land surface?',
                options: ['Mountains', 'Plains', 'Canyons', 'Plateaus'],
                correct: 1,
                explanation: 'Plains are the most common landform, covering vast areas of every continent!',
                funFact: '🌍 Without plains, we wouldn\'t have enough farmland to feed the world!'
            },
            {
                type: 'multiple-choice',
                difficulty: 'hard',
                question: 'Which mountain range is still growing taller each year?',
                options: ['Rocky Mountains', 'Appalachian Mountains', 'Himalayan Mountains', 'Andes Mountains'],
                correct: 2,
                explanation: 'The Himalayas grow about 4 millimeters taller each year due to tectonic plate movement!',
                funFact: '🏔️ Mount Everest is literally growing taller as you read this!'
            }
        ];

        // Initialize game state
        const game = new GameState();

        // Initialize the app
        function initializeApp() {
            createBackgroundParticles();
            game.updateXPDisplay();
            game.updateAchievementsDisplay();
            updateHighScores();
            applyTheme();
        }

        function createBackgroundParticles() {
            const container = document.getElementById('bgParticles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // Screen management
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            game.playSound('button');
        }

        // Study Mode
        function startStudyMode() {
            showScreen('studyScreen');
            game.currentStudyIndex = 0;
            displayLandformInfo();
        }

        function displayLandformInfo() {
            const landform = landformData[game.currentStudyIndex];
            const content = document.getElementById('studyContent');
            
            content.innerHTML = `
                <div style="text-align: center;">
                    <h2 class="title">${landform.emoji} ${landform.name}</h2>
                    <div class="landform-image-container">
                        <img src="${landform.imageUrl}" alt="${landform.name}" class="landform-image">
                        <div class="image-overlay">${landform.name}</div>
                    </div>
                    <p class="subtitle">${landform.description}</p>
                    <div class="fun-fact">
                        <h4 style="margin-bottom: 1rem; color: var(--primary-color);">🌟 Amazing Facts!</h4>
                        ${landform.facts.map(fact => `<p style="margin: 0.75rem 0;">• ${fact}</p>`).join('')}
                    </div>
                </div>
            `;
        }

        function nextLandform() {
            game.currentStudyIndex = (game.currentStudyIndex + 1) % landformData.length;
            displayLandformInfo();
            if (game.currentStudyIndex === landformData.length - 1) {
                game.showAchievement('study_master', 'Study Master!', 'You\'ve learned about all landforms!');
            }
        }

        function previousLandform() {
            game.currentStudyIndex = (game.currentStudyIndex - 1 + landformData.length) % landformData.length;
            displayLandformInfo();
        }

        // Quiz functionality
        function showDifficultySelection() {
            showScreen('difficultyScreen');
        }

        function startQuiz(difficulty) {
            game.difficulty = difficulty;
            game.gameMode = 'normal';
            resetQuizState();
            showScreen('quizScreen');
            loadQuestion();
        }

        function startTimeChallenge() {
            game.difficulty = 'medium';
            game.gameMode = 'challenge';
            resetQuizState();
            showScreen('quizScreen');
            document.getElementById('timerCard').style.display = 'block';
            document.getElementById('streakCard').style.display = 'block';
            loadQuestion();
        }

        function resetQuizState() {
            game.currentQuestion = 0;
            game.score = 0;
            game.answered = false;
            game.streak = 0;
            game.totalAnswered = 0;
            game.correctAnswers = 0;
            if (game.timer) clearInterval(game.timer);
            updateStats();
        }

        function getQuestionsByDifficulty() {
            if (game.difficulty === 'easy') {
                return questionData.filter(q => q.difficulty === 'easy');
            } else if (game.difficulty === 'hard') {
                return questionData.filter(q => q.difficulty === 'hard' || q.difficulty === 'medium');
            }
            return questionData;
        }

        function loadQuestion() {
            game.answered = false;
            selectedAnswerIndex = -1; // Reset selected answer
            const questions = getQuestionsByDifficulty();
            const question = questions[game.currentQuestion % questions.length];
            
            // Start timer for challenge mode
            if (game.gameMode === 'challenge') {
                startTimer();
            }
            
            // Update progress
            updateProgress();
            updateStats();
            
            // Hide next button
            document.getElementById('nextBtn').style.display = 'none';
            
            // Display question
            const content = document.getElementById('questionContent');
            content.innerHTML = `
                <div class="question-card">
                    <h3 class="question-text">${question.question}</h3>
                    <div class="options-grid">
                        ${question.options.map((option, index) => `
                            <button class="option-btn" data-index="${index}">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                    <div class="submit-container" id="submitContainer" style="display: none;">
                        <button class="btn btn-primary submit-btn" id="submitBtn">Submit Answer</button>
                    </div>
                    <div id="feedbackArea"></div>
                </div>
            `;
            
            // Add event listeners for iOS compatibility
            setTimeout(() => {
                const optionButtons = document.querySelectorAll('.option-btn');
                optionButtons.forEach((button, index) => {
                    // Remove any existing listeners
                    button.replaceWith(button.cloneNode(true));
                });
                
                // Re-select buttons after cloning
                const newButtons = document.querySelectorAll('.option-btn');
                newButtons.forEach((button) => {
                    const index = parseInt(button.getAttribute('data-index'));
                    
                    // Add both click and touchend for iOS compatibility
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        selectAnswer(index);
                    });
                    
                    button.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        selectAnswer(index);
                    });
                    
                    // Add cursor pointer for better UX
                    button.style.cursor = 'pointer';
                    button.style.webkitTapHighlightColor = 'transparent';
                });
            }, 10);
        }

        function startTimer() {
            game.timeLeft = 30;
            updateTimerDisplay();
            
            game.timer = setInterval(() => {
                game.timeLeft--;
                updateTimerDisplay();
                
                if (game.timeLeft <= 10) {
                    document.getElementById('timerCard').style.background = 'linear-gradient(135deg, #fee2e2, #fecaca)';
                }
                
                if (game.timeLeft <= 0) {
                    clearInterval(game.timer);
                    // Auto-submit when time runs out
                    selectedAnswerIndex = -1;
                    const question = game.questions[game.currentQuestion];
                    checkAnswer(-1, question.correct, 'Time\'s up!', 'Try to answer faster next time!');
                    document.getElementById('submitContainer').style.display = 'none';
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            document.getElementById('timerValue').textContent = game.timeLeft;
        }

        let selectedAnswerIndex = -1;

        function selectAnswer(index) {
            if (game.answered) return;
            
            // Remove previous selection
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.classList.remove('selected'));
            
            // Select new answer
            selectedAnswerIndex = index;
            buttons[index].classList.add('selected');
            
            // Show submit button
            const submitContainer = document.getElementById('submitContainer');
            submitContainer.style.display = 'block';
            
            // Add iOS-compatible event listeners to submit button
            const submitBtn = document.getElementById('submitBtn');
            if (submitBtn && !submitBtn.hasAttribute('data-listeners-added')) {
                submitBtn.setAttribute('data-listeners-added', 'true');
                
                submitBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    submitAnswer();
                });
                
                submitBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    submitAnswer();
                });
                
                submitBtn.style.cursor = 'pointer';
                submitBtn.style.webkitTapHighlightColor = 'transparent';
            }
        }

        function submitAnswer() {
            if (selectedAnswerIndex === -1 || game.answered) return;
            
            const question = game.questions[game.currentQuestion];
            checkAnswer(selectedAnswerIndex, question.correct, question.explanation, question.funFact || '');
            
            // Hide submit button after submission
            document.getElementById('submitContainer').style.display = 'none';
        }

        function checkAnswer(selected, correct, explanation, funFact) {
            if (game.answered) return;
            game.answered = true;
            game.totalAnswered++;
            
            // Clear timer
            if (game.timer) {
                clearInterval(game.timer);
                document.getElementById('timerCard').style.background = '';
            }
            
            // Check for speed achievement
            if (game.gameMode === 'challenge' && game.timeLeft > 25 && selected === correct) {
                game.showAchievement('speed_demon', 'Speed Demon!', 'Answered correctly in under 5 seconds!');
            }
            
            // Update buttons
            const buttons = document.querySelectorAll('.option-btn');
            if (selected >= 0 && buttons[selected]) {
                buttons[selected].classList.add(selected === correct ? 'correct' : 'incorrect');
            }
            
            // Handle correct/incorrect
            if (selected === correct) {
                game.score++;
                game.correctAnswers++;
                game.streak++;
                game.addXP(10 + (game.streak * 2)); // Bonus XP for streaks
                game.playSound('correct');
                
                // Check for first correct achievement
                if (game.correctAnswers === 1) {
                    game.showAchievement('first_correct', 'First Steps!', 'You got your first answer correct!');
                }
                
                // Check for streak achievements
                if (game.streak === 5) {
                    game.showAchievement('streak_5', 'On Fire!', 'Got 5 answers in a row!');
                } else if (game.streak === 10) {
                    game.showAchievement('streak_10', 'Unstoppable!', 'Amazing 10-answer streak!');
                }
            } else {
                if (buttons[correct]) {
                    buttons[correct].classList.add('correct');
                }
                game.streak = 0;
                game.playSound('incorrect');
            }
            
            // Show feedback
            showFeedback(selected === correct, explanation, funFact);
            
            // Disable buttons
            buttons.forEach(btn => {
                btn.style.cursor = 'default';
                btn.onclick = null;
            });
            
            // Show next button
            document.getElementById('nextBtn').style.display = 'block';
            updateStats();
        }

        function showFeedback(isCorrect, explanation, funFact) {
            const feedbackArea = document.getElementById('feedbackArea');
            let content = `
                <div class="feedback-card ${isCorrect ? 'success' : 'error'}">
                    <strong>${isCorrect ? '🎉 Correct!' : '❌ Not quite.'}</strong> ${explanation}
                </div>
            `;
            
            if (funFact) {
                content += `<div class="fun-fact">💡 <strong>Fun Fact:</strong> ${funFact}</div>`;
            }
            
            feedbackArea.innerHTML = content;
        }

        function nextQuestion() {
            game.currentQuestion++;
            if (game.currentQuestion < game.totalQuestions) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function updateProgress() {
            const percentage = ((game.currentQuestion + 1) / game.totalQuestions) * 100;
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressPercentage').textContent = Math.round(percentage) + '%';
        }

        function updateStats() {
            document.getElementById('scoreValue').textContent = game.score;
            document.getElementById('questionNumber').textContent = game.currentQuestion + 1;
            
            const accuracy = game.totalAnswered > 0 ? Math.round((game.correctAnswers / game.totalAnswered) * 100) : 0;
            document.getElementById('accuracyValue').textContent = accuracy + '%';
            
            if (game.gameMode === 'challenge') {
                document.getElementById('streakValue').textContent = game.streak;
            }
        }

        function showResults() {
            showScreen('resultsScreen');
            
            const percentage = Math.round((game.score / game.totalQuestions) * 100);
            document.getElementById('finalScoreDisplay').textContent = `${game.score}/${game.totalQuestions}`;
            
            // Determine message
            let message = '';
            if (percentage === 100) {
                message = '🎉 PERFECT SCORE! You\'re a Landform Master! 🏆';
                game.showAchievement('perfect_score', 'Perfect Explorer!', 'Got 100% on a quiz!');
                game.addXP(50); // Bonus XP for perfect score
                game.createCelebration();
            } else if (percentage >= 80) {
                message = '🌟 Excellent work! You really know your landforms!';
                game.addXP(30);
            } else if (percentage >= 60) {
                message = '👍 Good job! Keep studying to become a master!';
                game.addXP(20);
            } else {
                message = '💪 Keep learning! Every expert was once a beginner!';
                game.addXP(10);
            }
            
            document.getElementById('resultMessage').textContent = message;
            
            // Save high score
            saveHighScore(percentage);
            updateHighScores();
            
            // Check for challenge completion achievement
            if (game.gameMode === 'challenge') {
                game.showAchievement('time_master', 'Time Master!', 'Completed a speed challenge!');
            }
            
            game.playSound('complete');
        }

        function saveHighScore(percentage) {
            const newScore = {
                score: game.score,
                total: game.totalQuestions,
                percentage: percentage,
                date: new Date().toLocaleDateString(),
                mode: game.gameMode,
                difficulty: game.difficulty
            };
            
            game.highScores.push(newScore);
            game.highScores.sort((a, b) => b.percentage - a.percentage);
            game.highScores.splice(5); // Keep only top 5
            game.save();
        }

        function updateHighScores() {
            const list = document.getElementById('highScoresList');
            if (game.highScores.length === 0) {
                list.innerHTML = '<p style="color: var(--text-secondary);">No scores yet. Play a quiz to get started!</p>';
                return;
            }
            
            list.innerHTML = game.highScores.map((score, index) => `
                <div style="display: flex; justify-content: space-between; padding: 0.75rem; background: white; border-radius: 8px; margin: 0.5rem 0; border: 2px solid ${index === 0 ? '#fbbf24' : '#e2e8f0'};">
                    <span>${index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '🏅'} ${score.percentage}% (${score.score}/${score.total})</span>
                    <span style="color: var(--text-secondary);">${score.date}</span>
                </div>
            `).join('');
        }

        function restartQuiz() {
            showScreen('difficultyScreen');
        }

        function shareResults() {
            const text = `I just scored ${game.score}/${game.totalQuestions} on the Landform Explorer quiz! 🎉`;
            if (navigator.share) {
                navigator.share({
                    title: 'Landform Explorer Results',
                    text: text,
                    url: window.location.href
                });
            } else {
                // Fallback - copy to clipboard
                navigator.clipboard.writeText(text).then(() => {
                    alert('Results copied to clipboard! 📋');
                });
            }
            game.playSound('button');
        }

        // Control functions
        function toggleSound() {
            game.soundEnabled = !game.soundEnabled;
            const btn = document.getElementById('soundToggle');
            btn.textContent = game.soundEnabled ? '🔊' : '🔇';
            btn.style.background = game.soundEnabled ? '' : 'rgba(255, 255, 255, 0.5)';
            game.save();
            game.playSound('button');
        }

        function showHints() {
            // Could implement a hints system
            alert('💡 Hint: Look for key words in questions like "flat" for plains or "erupt" for volcanoes!');
            game.playSound('button');
        }

        function showSettings() {
            // Could implement settings panel
            alert('⚙️ Settings coming soon! For now, use the sound toggle and theme buttons.');
            game.playSound('button');
        }

        function toggleTheme() {
            const themes = ['default', 'nature', 'volcano', 'ocean'];
            const currentIndex = themes.indexOf(game.theme);
            const nextIndex = (currentIndex + 1) % themes.length;
            game.theme = themes[nextIndex];
            applyTheme();
            game.save();
            game.playSound('button');
        }

        function applyTheme() {
            const body = document.body;
            body.className = body.className.replace(/theme-\w+/g, '');
            if (game.theme !== 'default') {
                body.classList.add(`theme-${game.theme}`);
            }
        }

        // Home button function
        function goHome() {
            // Stop any running timers
            if (game.timer) {
                clearInterval(game.timer);
                game.timer = null;
            }
            
            // Reset quiz state if needed
            game.answered = false;
            
            // Go to home screen
            showScreen('homeScreen');
            game.playSound('button');
        }

        // Initialize the app when page loads
        window.addEventListener('load', initializeApp);

        // Add some fun keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ' && e.target.tagName !== 'BUTTON') {
                e.preventDefault();
                if (document.getElementById('nextBtn').style.display !== 'none') {
                    nextQuestion();
                }
            }
            
            // Home shortcut - Escape key
            if (e.key === 'Escape') {
                goHome();
            }
        });

        // Prevent iOS Safari bounce effect and zoom
        document.addEventListener('touchmove', function(e) {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // Prevent double-tap zoom on iOS
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>